# 雑記

* Intel記法とAT&T記法でのレジスタのsrc，dstの違いに注意．
* スタックはLIFOであることに注意．特に関数呼び出し．
* レジスタのバイト数によってレジスタの名称が異なるので注意．
* 関数呼び出しは，ABIに基づいた16バイトアラインメントが必要．
* 関数が呼び出された後にスタックポインタを下げて領域を確保する際に16の倍数にしておくと，16バイトアラインメントが維持される．
* なるべくpushでスタックに結果を一時退避させるのではなく，レジスタに直接飛ばす．スタックリークの発生要因になり得る．
* 加算・減算にはポインタの計算が含まれることに注意．
* ASTの作成と同時に意味解析をやるので，BNF通りにパースすることが難しい場合がある．あまりBNFにこだわらないこと．
* トークナイザは比較的実装が容易なので，インクリメンタルに開発するのではなく最初から全部作っても大丈夫そう．
* Rustの場合，連結リストを作ると記述が冗長になるので，Vecで代用できる部分はなるべくVecで代用する．
* 最初から網羅的に実装しようとすると破綻する．諦めが肝心．

# gdbを利用したデバッグ

```bash
gdb ./bin/tmp
(gdb) b 11 # アセンブリ上の確認したい行を指定し，ブレイクポイントを打つ
(gdb) run # ブレイクポイントまで実行
(gdb) info registers # レジスタの状態を確認
```

# リンク集

* [オンラインコンパイラ](https://godbolt.org/)
* [C23仕様書（PDF）](https://www.open-std.org/jtc1/sc22/wg14/www/docs/n3096.pdf)
* [C11仕様書（PDF）](https://www.open-std.org/jtc1/sc22/wg14/www/docs/n1570.pdf)
* [C11仕様書（HTML）](https://port70.net/~nsz/c/c11/n1570.html)
* [低レイヤを知りたい人のためのCコンパイラ作成入門](https://www.sigbus.info/compilerbook)
